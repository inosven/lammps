############### set variables for convenience

### model parameters

variable	kBT		equal 1.0
variable	seed		equal 2654868
variable	cut_att		equal 1.00
variable	cut_rep		equal 0.75
variable	cut_dis		equal 1.00
variable	pow_dis		equal 2.00
variable	cut_rho		equal 0.75
variable	cut_phi		equal 1.00
variable	skin		equal 0.3*${cut_att}

variable	rho_solids	equal 8.0

variable	A_att_11	equal -34 # fluid1--fluid1
variable	A_att_22	equal -34 # solid2--solid2
variable	A_att_12	equal -34 # fluid1--solid2

variable	B_rep		equal 25
variable	gamma		equal 12.4 # 4.5 18.0

variable	type_fluid1	equal 1
variable	type_solid2	equal 2

variable	phi_c		equal 0.5

variable	mass_fluid1	equal 1
variable	mass_solid2	equal 1

### domain parameters

variable	xlo		equal -10
variable	xhi		equal  10
variable	ylo		equal  0
variable	yhi		equal  50
variable	zlo		equal  0
variable	zhi		equal  50

### runtime parameters

variable	dt		equal 0.01

############### set units, dimension and global boundary type

units		lj
dimension	3
boundary	p p p
neighbor	${skin} bin
neigh_modify	delay 2
atom_style	mdpdsolidwall

############### create geometry and give number of atom types

lattice		fcc 4.0
region		box block ${xlo} ${xhi} ${ylo} ${yhi} ${zlo} ${zhi}
create_box	2 box
region		regID_ini block -5 5 0 50 0 50
create_atoms	${type_fluid1} random 150000 574856 regID_ini

group		group_fluid1 type ${type_fluid1}
group		group_solid2 type ${type_solid2}

############### specify bead-to-bead pair style and coefficients

pair_style	mdpdsolidwall ${kBT} ${cut_att} ${seed} group_solid2 group_fluid1

pair_coeff	1 1 ${A_att_11} ${B_rep} ${gamma} ${cut_att} ${cut_rep} ${cut_dis} ${pow_dis}
pair_coeff	1 2 ${A_att_12} ${B_rep} ${gamma} ${cut_att} ${cut_rep} ${cut_dis} ${pow_dis}
pair_coeff	2 2 ${A_att_22} ${B_rep} ${gamma} ${cut_att} ${cut_rep} ${cut_dis} ${pow_dis}
############### specify unit mass

mass		${type_fluid1} ${mass_fluid1}
mass		${type_solid2} ${mass_solid2}

############### specify time step size

timestep	${dt}

############### necessary to have this BC to compute local density

fix		BC all solidwall/mdpd group_solid2 group_fluid1 ${rho_solids} ${cut_phi} ${phi_c} ${cut_rho}

############### store velocity in ghost atoms

comm_modify	vel yes

############### set time step size and integration method

fix             TIME_INTEGRATE all mvv/mdpd 0.5
#fix		TIME_INTEGRATE all nvt temp 1.0 1.0 1.0

############### output thermodynamics every N timesteps
#thermo		100
#dump		1 all custom 100 out.dump id type xs ys zs vx vy vz

run		1000000

############### output dump file
compute		stress all stress/atom NULL
compute		p all reduce sum c_stress[1] c_stress[2] c_stress[3]
variable	stotal equal -(c_p[1]-0.5*(c_p[2]+c_p[3]))
fix		fixID_1 all ave/time 1 2000 2000 v_stotal file total_stress_single.dat

variable        pres atom  -(c_stress[1]-0.5*(c_stress[2]+c_stress[3]))

############### compute and output variable profiles
compute		cptID_prf all chunk/atom bin/1d x 0.0 0.1
 
fix		fixID_prf all ave/chunk 1 1000000 1000000 &
		cptID_prf density/number v_pres ave one file out.profile

#variable     ten11   equal  sum(f_fixID_prf[4])
#thermo 100
#thermo_style  custom  step v_ten11
#fix extra    all print  100 "$v_ten11" file tension.txt

#compute		my_pres all pressure thermo_temp
#variable	my_gamma equal lx*(c_my_pres[3]-(c_my_pres[1]+c_my_pres[2])/2.0)/2
thermo 100
thermo_style	custom step temp etotal pe ke lx  press pxx pyy pzz
#fix            press_tensor all  ave/time. 1 100 100 c_thermo_press[1] &
               c_thermo_press[2]  c_thermo_press[3] file press_tensor.dat
variable       tension  equal 0.5*lx*(pxx-0.5*(pyy+pzz))
fix            f_ten  all ave/time 1  2000  2000 v_tension file  surface_tensions.txt
fix            f_tension  all ave/time 1  1000000  1000000 v_tension file  surface_tension.txt   
############### production run
run		1000000
